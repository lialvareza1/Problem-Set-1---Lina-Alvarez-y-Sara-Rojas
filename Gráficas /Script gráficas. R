# Universidad de Los Andes - Problem Set 1
# Big Data y Machine Learning
# Lina Mar칤a 츼lvarez Ardila y Sara Roc칤o Rojas
# 03/03/25

# Cargar librer칤as necesarias
library(pacman)
p_load(ggplot2, tidyverse, readxl)

# Cargar datos desde Excel
data <- read_excel("C:/Users/yoyol/OneDrive/Escritorio/Universidad/Noveno semestre UNIANDES/Big Data and Machine Learning/Sesi칩n 1/Taller 1/GEIH Datos.xlsx",
                   na = c("NA", "Faltante", ""))

# Filtrar mayores de 18 a침os y ocupados, transformar variables
datos_18 <- data %>%
  filter(age > 18, ocu == 1) %>%
  mutate(y_salary_m = as.numeric(y_salary_m)) %>%
  filter(!is.na(y_salary_m), y_salary_m > 0) %>%
  mutate(maxeduclevel = as.numeric(as.character(maxeduclevel)))

# 游늵 Gr치fica 1: Distribuci칩n del Salario
ggplot(datos_18, aes(x = y_salary_m)) +
  geom_histogram(fill = "blue", bins = 50, alpha = 0.7) +
  labs(title = "Distribuci칩n del Salario", x = "Salario Mensual (COP)", y = "Frecuencia") +
  theme_minimal()

# 游늵 Gr치fica 2: Boxplot del Salario
ggplot(datos_18, aes(y = y_salary_m)) +
  geom_boxplot(fill = "red", alpha = 0.5) +
  labs(title = "Boxplot del Salario", y = "Salario Mensual (COP)") +
  theme_minimal()

# 游늵 Gr치fica 3: Dispersi칩n Salario vs Edad
ggplot(datos_18, aes(x = age, y = y_salary_m)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "loess", color = "blue") +
  labs(title = "Dispersi칩n Salario vs. Edad", x = "Edad", y = "Salario Mensual") +
  theme_minimal()
